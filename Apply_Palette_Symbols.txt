#NoEnv  			; Recommended for performance and compatibility with future AutoHotkey releases.
#Warn  				; Enable warnings to assist with detecting common errors.
SendMode Input  		; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir% 	; Ensures a consistent starting directory.
#SingleInstance force		; Replaces script (Reloads).
#Persistent			; to make it run indefinitely
#IfWinActive ahk_exe S:\MuseScore 3.6.2 portable\MuseScorePortable\App\MuseScore\bin\MuseScore3.exe	; Enables Hotkeys when MuseScore3 Window is Active


; this is an outcommented line
; replace the path S:\etc. with your location of MuseScore3.exe
; put the file Advanced AutoHotKey.workspace in the right location, see ->
; https://musescore.org/en/handbook/3/workspaces#Save-workspace
; for the portable version the location is ...:\MuseScore 3.6.2 portable\MuseScorePortable\Data\settings\workspaces

/*
NB: /* and */ are another way to outcomment lines.
Outcommented lines are not read by the program and don't influence speed of execution
*/

; determine the size and position of the InputBox in the docked Inspector using the tool Window Spy
; alternative position is near the mouse - this makes IB_X and IB_Y superfluous
; there are three occurrences of the Inputbox: searchterm #1 'Help = Questionmark'
; searchterm #2  'Enter Help or Symbol Shortcut' and searchterm #3 'Enter Symbol Shortcut'
; see the lines marked with (*change*?)IBpos 

W_IB := 289		; Width of InputBox 'Apply Symbols from Palette'
H_IB := 100		; Height of InputBox
IB_X := 1635		; Upper-left corner X InputBox in the docked Inspector
IB_Y := 806		; Upper-left corner Y idem

; ============================== ADDING EXTRA FUNCTIONALITY =======================================

; replace the coordinates valid for the test screen by your own
; if you don't need them you can outcomment them by putting a semicolon and a space in front of the line
; or just delete the lines

CoordMode, Tooltip, Screen			; creates reference of tooltip position
ToolTip_1_X := 332				; horizontal position
Tooltip, Palette Symbols, ToolTip_1_X, 0, 1	; actual tooltip, reminder that macro is active, y = 0, 1 is nr. of tooltip
ToolTip_2_X := ToolTip_1_X			; tooltip, 'More gracenotes'

; Canvas Search Area -  to search the color of a selected element
CSA_X1 := 120		; canvas search area upper-left corner
CSA_Y1 := 55
CSA_X2 := 1633		; canvas search area lower-right corner
CSA_Y2 := 1052

; for shortcut 1:||:2
; the coordinates of the Statusbar teach AHK where to look for the image 'Statusbar_Rest_Duration_Measure.png'
; when in the Defined State: determine the coordinates of the Statusbar search area
SB_X1 := 0		; extreme left border
SB_Y1 := 1038		; set the height so that the surface can accomodate 2 stacked statusbars
SB_X2 := 237		; this is needed because in some situations the statusbar can get an extra line
SB_Y2 := 1079		; in full screen this coordinate is the height (Y- resolution) of your screen minus 1 (pixel zero is the first pixel)

; create these 2 images, name them as indicated and put them in the working directory
; Statusbar_Rest_Duration_Measure.png
; IM_01_Inspector_Inspector.png

; the Defined State check needs IM_01_Inspector_Inspector.png
IM_01_X1 := 1639	; upper-left corner of search area X
IM_01_Y1 := 23		; idem Y
IM_01_X2 := 1697	; lower-right corner of search area X
IM_01_Y2 := 43		; idem Y

; for shortcut BPS - to position the pseudo barline  (presupposes defined state) we need
IN_021_X := 1806	; I(021) Y-offset - ELEMENT
IN_021_Y := 197		; OVERLAP - the hotspot must work for notes as well as texts

; to reset the inspector width to its defined state with the hotkey /+W:
; determine the X-coordinate of the Defined Inspector width approaching the separator from right to left
; so start at the right of the separator
; for maximum precision use the tool PixelMousing for this job
; see info pdf page 5

Min_Insp_Width := 1852		; my found minimal Inspector width (Inspector docked)
Def_Insp_Width := 1640		; my defined Inspector width
ToolTip , ◄ Separator x = %Def_Insp_Width%, Def_Insp_Width, 0, 3	; inspector (y=0)  (*change*?)

; tuning the quartertones of the Gould arrow accidentals (presupposes defined state)
IN_111_X := 1770	; I(111) Tuning
IN_111_Y := 666		; Note selected (Play must be ticked)
IN_112_X := 1905	; I(112) Reset Tuning
IN_112_Y := 666		; Note selected (Play must be ticked)

; colors of selected element - see MuseScore Preferences -> Advanced
; NB: AHK uses 0x instead of the '#' of MuseScore
; the numbers are the default ones

ColorV1 := 0x0065bf		; ui/score/voice1/color
ColorV2 := 0x007f00		; ui/score/voice2/color
ColorV3 := 0xc53f00		; ui/score/voice3/color
ColorV4 := 0xc31989		; ui/score/voice4/color

; ================================== END EXTRA FUNCTIONALITY ======================================

; Note about MuseScore shortcuts
; Send ^{F9}		; Palette Search (Ctrl+F9)
; Send ^!p		; Apply current palette element - (Ctrl+Alt+P)
; if you use other shortcuts search for the occurrences of Send ^{F9}  resp. Send ^!p
; In AHK you write ^ for Control   ! for Alt    + for Shift

; =================================== LISTING THE SHORTCUTS =======================================

; SHORTCUTLIST Apply Palette Symbols
; if you want to add new Palette items: check this listing first to avoid duplicates
; and add the new shortcut to this list

MatchListPalettes = 0,1,1:||:2,2,3,4,5,0c,1c,1fb,1fn,1sn,1s#
,2c,3c,3fb,3fbb,3sx,3s#,4c,5c,5fbb,5sx,6c
,2/4,3/4,4/4,5/4,6/4,7/4,3/8,4/8,2+3/8,3+2/8,6/8,7/8,3+3+2/8,3+2+2+3/8,9/8,11/8,12/8,c4/4,c2/2,2/2,3/2,4/16,5/16,6/16
,.2,2=,.4,4=,.6,6=,8,8=,16,16=,32,32=,64,64=
,1#,2#,3#,4#,5#,6#,7#,1b,1m,2b,3b,4b,5b,6b,7b,0#0b,xsig
,1v,2v,2vo,3v,8va,8vb,15ma,15mb,22ma,22mb
,|,||,|||,|:,:|,:||:,|a,|a,|aad,|aau,|ab,|apd,|apu,|d,|gls,|glw,|hf,|p,|s,|sia,|sib,|sod,|sou
,=ab,=fbf,=fbs,=sb,=mb,=nb,=16b,=32b
,-a,-c,-i,-m,-p
,#,##,#a,#ci,#e,#m,#o,#p,#rm,#s,#stc,#sw,#t,#tr
,@,!,!!,@!,@#,[],(),+,+t/,.,..,....,----,..s,..w,.a,.l,.m,.t,<,>
,[[,[{,[l,[s
,*ab,*c,*cl,*d,*do,*lar,*n,*td,*tu,*x,*+,*xc,*xx,*/,*\,*//
,?,??,?a,?ag,?b,?bl,?bp,?br,?bs,?c,?cm,?d,?f,?fd,?fm,?g,?gn,?h,?i,?k,?ks,?l,?m,?n,?nh
,?o,?p,?q,?r,?rj,?t,?tr,?ts,?u,?v,?w,?x,?z,?[
,a,a.,a>,a<,aad,aau,ab,ac,acs,ada,adag,adagi,adagio,allegre,allegretto,allegro
,alro,alto,am,and,anda,andan,andante,ap,apd,aps,apu,ar,arco,arp,arpdown,arpup,at
,b,b.,bd,ber,besr,bf,bmc,bmt,bms,bmv,bn,bps,br,bs1,bs2,bsr,bt1,bt2,bupb,buzz
,c,c!,!c,c1,c2,c),c/,c||,c//,ci,cla,clb,clbar,clbarf,clb8va,clb8vb,clb15ma
,clb15mb,cldt8vb,clfvc,clms,clp,clp2,cls,clsb,clt,cltab,cltab4,clten,clto8vb
,clt8va,clt8vb,clt15ma,clt15vb,cm1,cm2,cm3,cm4,cm5,cm6,cm7,cm8,cm9,cm10,cm11,cm12,cm13,cm14,cm15
,coda,crotchet,crotchet.,cv
,d,dash,db,dc,dcac,dcaf,do,doit,dm,dnb,dnbb,dns,dnx,dpl,dpr,ds,dsac,dsaf,dsq,dsq=,er,esr,ex,expr
,f,f!,!f,fa,fall,ff,fff,fi,fine,fo,fm,fp,fsa,fsb,fz
,g3,g3a,g3as,g3asn,g3s,g4,g4s,g6,g6a,g6as,g6asn,g6s,g8a,gls,gra,grav,grave,gv,gvw
,h,hdsq,hdsq=,hf,im
,l,l.,l1,l2,l3,la,lar,larg,largo,len,lent,lento,lfm,lfmh,lpr,lr,lt,lv
,m,m.,m*,m2,m2.,m4,m4.,m8,m8.,mi,minim,minim.,mp,mf,mfcp
,mm2=4,mm4=2,mm4=4,mm4=4.,mm4.=4,mm8=8,mmc=c,mmc=c.,mmc.=c,mmc=m,mmm=c,mmq=q
,mod,mode,moder,moderato
,mt,mu,mup,mute,n*,nal,ndn,o,op,open
,p,p0,p1,p2,p3,p4,p5,p.,pb,pcc,pcr,pi,pizz,plop,pm,pp,ppl,ppp,pr,prd,pre,pres,prest,presto,prm,pru
,ps*,psc,psr,pss
,q,q=,qa,qam,qa7,qb,qbm,qb7,qc,qcm,qc7,qd,qdm,qd7
,qe,qem,qe7,qf,qfm,qf7,qg,qgm,qg7,quaver,quaver.
,r,r*,r m,r-m,re,rf,rfz,rm,rm!,!rm,rt
,s,s..,s1,s2,s*,s!,!s,sa,sa.,salz,sat,sat.,sb,scoop,segno,sf,sff,sfm,sfmh,sfp,sfpp,sfz,sffz,shtr
,sia,sib,sib,sl,slide,sls,sod,sol,sou,sp,sq,sq=,sr,ss,ssd,ssf,ssu,st,staff,stc
,str,sup,sv,sw,sy,sys,system,swls
,t,t.,-t,-turn,+t,+turn,ta,tb,tc,tf,th,ti,tl,tm,tp,tr,trem,tremolo,trl,trmb,tsaw,turn
,ub,um,unstr,upb,upl,upm,upn,upr
,vc,vf,viv,viva,vivac,vivace,vlf,vlfm,vs,vsaw,vsfm
,w..
,xb,xup
,z*
,Help = Questionmark

; ♣============================== END OF AUTO-EXECUTE SECTION =====================================

; ♣========================================= RELOAD ===============================================

; useful while editing this file - you can outcomment it afterwards with semicolon and space

^!r::reload			; Control + Alt + R

; ♣==================================== APPLY PALETTE SYMBOLS =====================================

~z & a::					; apply palette symbols
MouseGetPos, StartX, StartY			; position mouse
InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, IB_X, IB_Y, , , Help = Questionmark	;  (*change*?) 
; InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, StartX, StartY+100, , , Help = Questionmark	;  here the InputBox is positioned near the mouse 100 pixels lower (*change*?)IBpos
if ErrorLevel					; when Cancel is pressed
    Return

If (PaletteSymbol = "nal")			; note anchored line
    Goto, CreateNAL				; at the end of the script
If PaletteSymbol not in %MatchListPalettes%
{
    MsgBox, 4144, Apply Symbols from Palette, No valid command.`nThe macro will exit.
    Return
}

If (PaletteSymbol = "r")
    PaletteSymbol := PaletteSymbolOld

If (PaletteSymbol = "?") || (PaletteSymbol = "Help = Questionmark")
{
MsgBox, 4096, Info Palettes,
(
Enter a help shortcut or a symbol shortcut

► Accidentals			?X
► Arpeggios & Glissandi		?V	?AG
► Articulations			?A
► Barlines			?B	?BL
► Beam Properties			?Z
► Brackets			?[	?BR
► Breaks & Spacers		?I	?BS
► Breath's & Pauses		?P	?BP
► Clefs				?C
► Colored Markers		?CM
► Dynamics			?D
► Fingering			?F
► Frames & Measures		?H	?FM
► Fretboard Diagrams		?Q	?FD
► Grace Notes			?G	?GN
► Key Signatures			?K	?KS
► Lines				?L
► Noteheads			?N	?NH
► Ornaments			?O
► Repeats & Jumps		?R	?RJ
► Tempo				?M
► Text				?T
► Time Signatures			?TS
► Tremolo			?W	?TR

Info Tools			??
Repeat last command		R
)
    InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, IB_X, IB_Y, , , Enter Help or Symbol Shortcut	;  (*change*?) 
;    InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, StartX, StartY+100, , , Enter Help or Symbol Shortcut	;  here the InputBox is positioned near the mouse (*change*?)IBpos
    if ErrorLevel				; when Cancel is pressed
    {
        Click, %StartX%, %StartY%
        Return
    }
}
If (PaletteSymbol = "Enter Help or Symbol Shortcut")
{
    MsgBox, 4096, Apply Symbols from Palette, "Enter Help or Symbol Shortcut"`nis no valid input.`nThe macro will exit.
    Return
}

If (PaletteSymbol = "??")
{
MsgBox, 4096, Info Tools,
(
Reset width inspector		/ + W
Load PixelMousing		/ + P
Help PixelMousing		/ + H
Exit PixelMousing			/ + E
)
    Return
}

If (PaletteSymbol = "?x")
{
MsgBox, 4096, Accidentals - shortcuts,
(
In InputBox enter:

Flat				!
Natural				@
Sharp				#
Double sharp			##
Double flat			!!
Natural Flat			@!
Natural Sharp			@#

Gould arrow quartertone accidentals (24-EDO)

Quarter-tone flat			UPB	↑♭	1FB
Three-quarter-tones flat		DNB	↓♭	3FB
Quarter-tone sharp		UPN	↑♮	1SN
Quarter-tone flat			NDN	♮↓	1FN
Three-quarter-tones sharp		SUP	♯↑	3S#
Quarter-tone sharp		DNS	↓♯	1S#
Five-quarter-tones sharp		XUP	×↑	5SX
Three-quarter-tones sharp		DNX	↓×	3SX
Three-quarter-tones flat		BUPB	♭↑♭	3FBB
Five-quarter-tones flat		DNBB	↓♭♭	5FBB
Reset tuning			RT

Add brackets to accidental		[ ]
Add parentheses to element	( )
)
}

If (PaletteSymbol = "?v") || (PaletteSymbol = "?ag")
{
MsgBox, 4096, Arpeggios & Glissandi - shortcuts,
(
In InputBox enter:

Arpeggio			|A	ARP
Arpeggio point up		|APU	APU	ARPUP
Arpeggio point down		|APD	APD	ARPDOWN
Arpeggio bracket			|AB	AB
Arpeggio arrow up		|AAU	AAU
Arpeggio arrow down		|AAD	AAD
Glissando line straight		|GLS	GLS
Glissando line wiggle		|GLW	GLW
Fall				|F	FALL
Doit				|D	DOIT
Plop				|P	PLOP
Scoop				|S	SCOOP
Slide out down			|SOD	SOD
Slide out up			|SOU	SOU
Slide in above			|SIA	SIA
Slide in below			|SIB	SIB
)
}

If (PaletteSymbol = "?a")
{
MsgBox, 4096, Articulations - shortcuts,
(
In InputBox enter:

Accent			A
Accent staccato		A.	.A	
Bend			B
Downbow		DB
Fade in			FI
Fade out			FO
Fermata			FM
Harmonic		H
Laissez vibrer		LV
Long fermata		LFM
Long fermata Henze	LFMH
Louré			L.
Marcato			M
Marcato staccato		M.	.M
Marcato tenuto		MT	TM
Muted			+
Open			O
Portato			P.
Sawtooth line segment	SLS
Idem wide line segment	SWLS
Short fermata		SFM
Short fermata Henze	SFMH
Snap pizzicato		SP
Soft accent		SA
Soft accent staccato	SA.
Soft accent tenuto		SAT
Idem SAT staccato		SAT.
Staccato			.
Staccatissimo		..
Staccatissimo stroke	..S	S..
Staccatissimo wedge	..W	W..
Stress			STR
Tenuto			T
Tenuto accent		TA	AT
Tenuto staccato		T.	.T
Tremolo bar		TB
Unstress			UNSTR
Upbow			UB
Very long fermata		VLFM
Very short fermata		VSFM
Vibrato large faster	VLF
Vibrato large slowest	VLS
Volume swell		VS
)
}

If (PaletteSymbol = "?o")
{
MsgBox, 4096, Ornaments - shortcuts,
(
In InputBox enter:

Inverted turn			-T	-TURN
Turn				+T	+TURN	TURN
Turn with slash			+T/
Trill				TR
Short trill			SHTR
Upper Mordent, Prall		UM	PR
Lower, Inverted Mordent		IM
Tremblement			TRMB
Prall mordent			PRM
Up prall				UPR
Mordent upper prefix		MUP
Up mordent			UPM
Down prall			DPR
Prall down			PRD
Down mordent, Prall up		DM	PRU
Prall up, Line Prall			LPR
Slide				SL	SLIDE
)
}

If (PaletteSymbol = "?b") || (PaletteSymbol = "?bl")
{
MsgBox, 4096, Barlines - shortcuts,
(
In InputBox enter:

Barline normal		BN	|
Barline double		BD	||
Barline start repeat	BSR	|:
Barline end repeat		BER	:|
Barline end-start repeat	BESR	:||:
Barline dashed		DASH	----
Barline final		BF	|||
Barline dotted		B.	....
Barline tick 1 span #	BT1
Barline tick 2 span #	BT2
Barline short 1 span #	BS1
Barline short 2 span #	BS2
Barline pseudo (symbol)	BPS

Combination
┌─1─┐:‖:┌─2──		1:||:2

# To reset these barlines use Inspector
)
}

If (PaletteSymbol = "?g") || (PaletteSymbol = "?gn")
{
MsgBox, 4096, Grace Notes - shortcuts,
(
In InputBox enter:

Acciaccatura				AC
Acciaccatura #				ACS
Appogiatura				AP
Appogiatura #				APS
Grace quarter				G4
Grace 16th				G6
Grace 16th *				G6S
Grace 32nd				G3
Grace 32nd * 				G3S
Grace eight after				G8A
Grace 16th after				G6A
Grace 16th after ∆ 				G6AS
Grace 32nd after				G3A
Grace 32nd after ∆				G3AS

# diatonically raised + slur

For all 16th and 32nd Grace Notes:
After the first to create another: press	Y
To stop adding grace notes: press		N

*  Adds a slur from  first grace-note-before to main note

∆ Adds a slur from main-note-before to main-note-after
)
}

If (PaletteSymbol = "?n") || (PaletteSymbol = "?nh")
{
MsgBox, 4096, Noteheads - shortcuts,
(
In InputBox enter:

Alt brevis			*AB
Circled			*C
Circled large		*CL
Cross			*X
Diamond			*D
Diamond old		*DO
Large arrow		*LAR
Normal			*N
Plus			*+
Slash			*//
Slashed forwards		*/
Slashed backwards	*\
Triangle up		*TU
Triangle down		*TD
With X			*XX
X circle			*XC

Do			DO
Re			RE
Mi			MI
Fa			FA
Sol			SOL
La			LA
Ti			TI

Add parentheses
to element		( )
)
}

If (PaletteSymbol = "?f")
{
MsgBox, 4096, Fingering - shortcuts,
(
In InputBox enter:

Piano		LH Guitar
0	P0	0	0
1	P1	1	1
2	P2	2	2
3	P3	3	3
4	P4	4	4
5	P5	5	5
		T	TH

Circled String	RH Guitar
0	0c	p	-P
1	1c	i	-I		
2	2c	m	-M		
3	3c	a	-A		
4	4c	c	-C		
5	5c	Th pos	TP
6	6c	

Lute
RH thumb		LT
RH first finger		L1
RH second finger		L2
RH third finger		L3

Finger substitution above	FSA
Finger substitution below	FSB
)
}

If (PaletteSymbol = "?p") || (PaletteSymbol = "?bp")
{
MsgBox, 4096, Breath's & Pauses - shortcuts,
(
In InputBox enter:

Breath mark (comma)	BMC
Breathmark tick-like	BMT
Breathmark salzedo	BMS	SALZ
Breathmark upbow-like	BMV
Curved caesura		C)
Caesura straight		C/
Short caesura		C||
Thick caesura		C//
)
}

If (PaletteSymbol = "?c")
{
MsgBox, 4096, Clefs - shortcuts,
(
In InputBox enter:

Treble			CLT
Treble 8va		CLT8VA
Treble 15ma		CLT15MA
Treble 8vb		CLT8VB
Treble 15vb		CLT15VB
Double Treble 8vb		CLDT8VB
Treble optional 8vb	CLTO8VB
French violin clef		CLFVC
Soprano			CLS
Mezzo Soprano		CLMS
Alto			CLA
Tenor			CLTEN
Baritone			CLBAR
Bass			CLB
Bass 8va			CLB8VA
Bass 15ma		CLB15MA
Bass 8vb			CLB8VB
Bass 15mb		CLB15MB
Baritone F clef		CLBARF
Subbass			CLSB
Percussion		CLP
Percussion 2		CLP2
Tablature		CLTAB
Tablature 4 lines		CLTAB4
)
}

If (PaletteSymbol = "?cm")
{
MsgBox, 4096, Colored Marker Numbers - shortcuts,
(
User text style 'Colored Numbers'
Font Edwin, bold, 12pt,
independent on staff size

In InputBox enter:

Colored Marker Number 1		CM1
Colored Marker Number 2		CM2
etc. 3...14

Colored Marker 15			CM15

# 15 is the color of 'invisible' elements
)
}

If (PaletteSymbol = "?k") || (PaletteSymbol = "?ks")
{
MsgBox, 4096, Key Signatures - shortcuts,
(
In InputBox enter:

MAJOR	MINOR	ENTER

G	E	1#
D	B	2#
A	F♯	3#
E	C♯	4#
B	G♯	5#
F♯	D♯	6#
C♯	A♯	7#

F	D	1b
B♭	G	2b
E♭	C	3b
A♭	F	4b
D♭	B♭	5b
G♭	E♭	6b
C♭	A♭	7b

C	A	0#0b

Open Atonal	XSIG
)
}

If (PaletteSymbol = "?d")
{
MsgBox, 4096, Dynamics - shortcuts,
(
In InputBox enter:

PPP	PP	P	MP	MF	F	FF	FFF
RF	RFZ	FZ	SF	SFZ	SFF	SFFZ	
SFPP	SFP	FP	M*	R*	S*	Z*	N*
)
}

If (PaletteSymbol = "?l")
{
MsgBox, 4096, Lines - shortcuts,
(
In InputBox enter:

Ambitus #		AM
Cresc---			C
Dim---			D
Downprall line		DPL
Guitar vibrato		GV
Guitar vibrato wide	GVW
Hairpin crescendo		<
Hairpin decrescendo	>
Let ring			LR
Line			L
mf cresc pin		MFCP
Note anchored line	NAL
Palm mute		PM
Prall prall line		PPL
Prima volta		1V
Seconda volta		2V
Seconda volta open	2VO
Slur			S
Terza volta		3V
Text line			TL
Tremolo sawtooth wide	TSAW
Trill line			TRL
Upprall line		UPL
Vibrato sawtooth		VSAW

# Select clef

Pedline continue-continue	PCC
Pedline continue-release	PCR
Pedline start-continue	PSC
Pedline start-stop		PSS
Pedline start-asterisk	PS*
Pedline start-release	PSR
Octaves			8VA
			8VB
			15MA
			15MB
			22MA
			22MB

Combination
┌─1─┐:‖:┌─2──		1:||:2
)
}

If (PaletteSymbol = "?w") || (PaletteSymbol = "?tr")
{
MsgBox, 4096, Tremolos - shortcuts,
(
In InputBox enter:

1/8	stroke through stem	8		Q
1/16	stroke through stem	16	.6	SQ
1/32	stroke through stem	32	.2	DSQ
1/64	stroke through stem	64	.4	HDSQ

1/8	between notes		8=		Q=
1/16	between notes		16=	6=	SQ=
1/32	between notes		32=	2=	DSQ=
1/64	between notes		64=	4=	HDSQ=

Buzzroll				BR	BUZZ
)
}

If (PaletteSymbol = "?t")
{
MsgBox, 4096, Text - shortcuts,
(
In InputBox enter:

Stafftext			#T	ST	STAFF
System text		#S	SY	SYS	SYSTEM
Expression text 		#E	EX	EXPR
Change Instrument	#CI	CI
Staff type change		#STC	STC
Rehearsal mark 		#RM	RM
Swing			#SW	SW
Pizzicato			#P	PIZZ	PI
Arco			#A	ARCO	AR
Tremolo			#TR	TREM	TREMOLO
Mute			#M	MUTE	MU
Open			#O	OPEN	OP
)
}

If (PaletteSymbol = "?m")
{
MsgBox, 4096, Tempo - shortcuts,
(
In InputBox enter:

Half note =80		M2	MINIM
Half note dotted =80	M2.	MINIM.
Quarter =80		M4	CROTCHET
Quarter dotted =80	M4.	CROTCHET.
Eight =80		M8	QUAVER
Eight dotted =80		M8.	QUAVER.
Grave 35			GRA	GRAV	GRAVE
Largo 50			LAR	LARG	LARGO	
Lento 52			LEN	LENT	LENTO
Adagio 71		ADA	ADAG	ADAGI	ADAGIO
Andante 92		AND	ANDA	ANDAN	ANDANTE
Moderato 114		MOD	MODE	MODER	MODERATO
Allegretto 116		ALTO	A>	ALLEGRE	ALLEGRETTO
Allegro 144		ALRO	A<	ALLEGRO
Vivace 172		VIV	VIVA	VIVAC	VIVACE
Presto 187		PRE	PRES	PREST	PRESTO

METRIC MODULATION

Quarter=dotted quarter		MM4=4.		MMC=C.
Dotted quarter=quarter		MM4.=4		MMC.=C
Half=quarter			MM2=4		MMM=C
Quarter=half			MM4=2		MMC=M
Eight=eight			MM8=8		MMQ=Q
Quarter=quarter			MM4=4		MMC=C
)
}

If (PaletteSymbol = "?r") || (PaletteSymbol = "?rj")
{
MsgBox, 4096, Repeats and Jumps - shortcuts,
(
In InputBox enter:

Repeat measure			RM!	!RM	R-M	R M
Segno				S!	!S	S1          SEGNO
Segno serpent § (variation)		SS	SV	S2
Coda Φ				C!	!C	C1	CODA
Varied coda			VC	CV	C2
Fine				F!	!F	FINE
To Coda				TC
Da Capo				DC
Da Capo al Fine			DCAF
Da Capo al Coda			DCAC
Dalle Segno al Coda		DSAC
Dalle Segno al Fine		DSAF
D.S.				DS
Start repeat			SR	|:
End repeat			ER	:|
End-start repeat			ESR	:||:
)
}

If (PaletteSymbol = "?q") || (PaletteSymbol = "?fd")
{
MsgBox, 4096, Fretboard diagrams - shortcuts,
(
QA		QA7		QAm
QB		QB7		QBm
QC		QC7		QCm
QD		QD7		QDm
QE		QE7		QEm
QF		QF7		QFm
QG		QG7		QGm
)
}

If (PaletteSymbol = "?h") || (PaletteSymbol = "?fm")
{
MsgBox, 4096, Frames & Measures - shortcuts,
(
In InputBox enter:

Insert vertical frame		VF
Insert horizontal frame		HF
Insert text frame			TF
Insert one measure		1M
)
}

If (PaletteSymbol = "?ts")
{
MsgBox, 4096, Time Signatures - shortcuts,
(
In InputBox enter:

FOR		ENTER

2/4		2/4
3/4		3/4
4/4		4/4
5/4		5/4
6/4		6/4
7/4		7/4
C		C4/4
₵		C2/2
2/2		2/2
3/2		3/2
3/8		3/8
4/8		4/8
2+3/8		2+3/8
3+2/8		3+2/8
6/8		6/8
7/8		7/8
3+3+2/8		3+3+2/8
9/8		9/8
3+2+2+3/8	3+2+2+3/8
11/8		11/8
12/8		12/8
4/16		4/16
5/16		5/16
6/16		6/16
)
}

If (PaletteSymbol = "?[") || (PaletteSymbol = "?br")
{
MsgBox, 4096, Brackets - shortcuts,
(
⁞	In InputBox enter:
⁞
⁞	Bracket		[ [
⁞	Brace		[ {
⁞	Square		[ S
⁞	Line		[ L
)
}

If (PaletteSymbol = "?i") || (PaletteSymbol = "?bs")
{
MsgBox, 4096, Breaks & Spacers - shortcuts,
(
In InputBox enter:

System break			SB
Page break			PB
Section break			XB
Staff spacer down			SSD
Staff spacer up			SSU
Staff spacer fixed			SSF
)
}

If (PaletteSymbol = "?z")
{
MsgBox, 4096, Beam Properties - shortcuts,
(
In InputBox enter:

Start a beam			=SB
Middle beam			=MB
No beam				=NB
Start second level beam		=16B
Beam 16th sub			=16B
Start third level beam		=32B
Beam 32th sub			=32B
Autobeam			=AB
Feathered beam slower #		=FBS
Feathered beam faster #		=FBF

# Select beam. Reset in Inspector
)
}

If PaletteSymbol in ?a,?ag,?b,?bl,?bp,?br,?bs,?c,?d,?f,?fd,?fm,?g,?gn,?h,?i,?k,?ks,?l,?m,?n,?nh
,?o,?p,?q,?r,?rj,?t,?tr,?ts,?u,?v,?w,?x,?z,?[
{
    InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, IB_X, IB_Y, , , Enter Symbol Shortcut	;  (*change*?) 
;    InputBox, PaletteSymbol, Apply Symbols from Palette, , , W_IB, H_IB, StartX, StartY+100, , , Enter Symbol Shortcut	;  here the InputBox is positioned near the mouse (*change*?)IBpos
    if ErrorLevel				; when Cancel is pressed
    {
        Click, %StartX%, %StartY%
        Return
    }
}
If (PaletteSymbol = "nal")			; note anchored line
    Goto, CreateNAL				; at the end of the script
If (PaletteSymbol = "Enter Symbol Shortcut")
{
    MsgBox, 4096, Apply Symbols from Palette, "Enter Symbol Shortcut"`nis no valid input.`nThe macro will exit.
    Return
}
If PaletteSymbol not in %MatchListPalettes%
{
    MsgBox, 4112, Apply Symbols from Palette, No valid command.`nThe macro will exit.
    Return
}
PaletteSymbolOld := PaletteSymbol		; stores value in 'PaletteSymbolOld' for repeat command 
Send ^{F9}					; Palette Search (Ctrl+F9) (*change*?)
Sleep, 100

; ♣========================================== CLEFS ===============================================
; shortcuts in this section
; ,clt,clt8va,clt15ma,clt8vb,clt15vb,cldt8vb,clto8vb,clfvc,cls,clms,cla,clten,clbar
; ,clb,clb8va,clb15ma,clb8vb,clb15mb,clbarf,clsb,clp,clp2,cltab,cltab4

If (PaletteSymbol = "clt")			; Treble
    Send c-1-
If (PaletteSymbol = "clt8va")			; Treble 8va
    Send c-2-
If (PaletteSymbol = "clt15ma")			; Treble 15ma
    Send c-3
If (PaletteSymbol = "clt8vb")			; Treble 8vb
    Send c-4
If (PaletteSymbol = "clt15vb")			; Treble 15vb
    Send c-5
If (PaletteSymbol = "cldt8vb")			; Double Treble 8vb
    Send c-6
If (PaletteSymbol = "clto8vb")			; Treble optional 8vb
    Send c-7
If (PaletteSymbol = "clfvc")			; French violin clef
    Send c-8
If (PaletteSymbol = "cls")			; Soprano
    Send c-9
If (PaletteSymbol = "clms")			; Mezzo Soprano
    Send c-10
If (PaletteSymbol = "cla")			; Alto
    Send c-11
If (PaletteSymbol = "clten")			; Tenor
    Send c-12
If (PaletteSymbol = "clbar")			; Baritone
    Send c-13
If (PaletteSymbol = "clb")			; Bass
    Send c-14
If (PaletteSymbol = "clb8va")			; Bass 8va
    Send c-15
If (PaletteSymbol = "clb15ma")			; Bass 15ma
    Send c-16
If (PaletteSymbol = "clb8vb")			; Bass 8vb
    Send c-17
If (PaletteSymbol = "clb15mb")			; Bass 15mb
    Send c-18
If (PaletteSymbol = "clbarf")			; Baritone F clef
    Send c-19
If (PaletteSymbol = "clsb")			; Subbass
    Send c-20
If (PaletteSymbol = "clp")			; Percussion
    Send c-21
If (PaletteSymbol = "clp2")			; Percussion 2
    Send c-22
If (PaletteSymbol = "cltab")			; Tablature
    Send c-23
If (PaletteSymbol = "cltab4")			; Tablature 4 lines
    Send c-24

; ♣=============================== KEY SIGNATURES ======================================
; shortcuts in this section
; ,1#,2#,3#,4#,5#,6#,7#,7b,6b,5b,4b,3b,2b,1b,0#0b,xsig

If (PaletteSymbol = "1#")			; 1#
    Send k-1-
If (PaletteSymbol = "2#")			; 2#
    Send k-2
If (PaletteSymbol = "3#")			; 3#
    Send k-3
If (PaletteSymbol = "4#")			; 4#
    Send k-4
If (PaletteSymbol = "5#")			; 5#
    Send k-5
If (PaletteSymbol = "6#")			; 6#
    Send k-6
If (PaletteSymbol = "7#")			; 7#
    Send k-7
If (PaletteSymbol = "7b")			; 7b
    Send k-8
If (PaletteSymbol = "6b")			; 6b
    Send k-9
If (PaletteSymbol = "5b")			; 5b
    Send k-10
If (PaletteSymbol = "4b")			; 4b
    Send k-11
If (PaletteSymbol = "3b")			; 3b
    Send k-12
If (PaletteSymbol = "2b")			; 042, 2b
    Send k-13
If (PaletteSymbol = "1b")			; 1b
    Send k-14
If (PaletteSymbol = "0#0b")			; 0# 0b
    Send k-15
If (PaletteSymbol = "xsig")			; Xsig - Atonal
    Send k-16

; ♣============================== TIME SIGNATURES ======================================
; shortcuts in this section
; ,2/4,3/4,4/4,5/4,6/4,7/4,3/8,2+3/8,3+2/8,6/8,7/8,3+3+2/8,3+2+2+3/8,9/8,11/8,12/8,c4/4,2/2,c2/2,3/2,4/16,5/16,6/16
; Send {Raw} is used to ensure + 'is' read literally instead as Shift

If (PaletteSymbol = "2/4")			; 2/4
    Send 2/4
If (PaletteSymbol = "3/4")			; 3/4
    Send 3/4
If (PaletteSymbol = "4/4")			; 4/4
    Send 4/4-
If (PaletteSymbol = "5/4")			; 5/4
    Send 5/4
If (PaletteSymbol = "6/4")			; 6/4
    Send 6/4
If (PaletteSymbol = "7/4")			; 7/4 added
    Send 7/4
If (PaletteSymbol = "3/8")			; 3/8
    Send 3/8
If (PaletteSymbol = "4/8")			; 4/8 added
    Send 4/8
If (PaletteSymbol = "2+3/8")			; 2+3/8 added
    Send {Raw}2+3/8
If (PaletteSymbol = "3+2/8")			; 3+2/8 added
    Send {Raw}3+2/8
If (PaletteSymbol = "3+3+2/8")			; 3+3+2/8 added
    Send {Raw}3+3+2/8
If (PaletteSymbol = "3+2+2+3/8")		; 3+3+2+3/8 added
    Send {Raw}3+2+2+3/8
If (PaletteSymbol = "6/8")			; 6/8
    Send 6/8
If (PaletteSymbol = "7/8")			; 7/8
    Send 7/8
If (PaletteSymbol = "9/8")			; 9/8
    Send 9/8
If (PaletteSymbol = "11/8")			; 11/8 added
    Send 11/8
If (PaletteSymbol = "12/8")			; 12/8
    Send 12/8
If (PaletteSymbol = "c4/4")			; C 4/4
    Send c4/4
If (PaletteSymbol = "c2/2")			; ₵ 2/2
    Send c2/2
If (PaletteSymbol = "2/2")			; 2/2
    Send 2/2-
If (PaletteSymbol = "3/2")			; 3/2
    Send 3/2
If (PaletteSymbol = "4/16")			; 4/16 added
    Send 4/16
If (PaletteSymbol = "5/16")			; 5/16 added
    Send 5/16
If (PaletteSymbol = "6/16")			; 6/16 added
    Send 6/16

; ♣================================= ACCIDENTALS =======================================
; shortcuts in this section
; ,!,!!,@,#,##,@!,@#,[],(),1fb,1fn,1sn,1s#,3fb,3fbb,3sx,3s#,5fbb,5sx
; upb,dnb,upn,ndn,sup,dns,xup,dnx,bupb,dnbb

If (PaletteSymbol = "!")			; Flat
    Send x-1
If (PaletteSymbol = "@")			; Natural
    Send x-2
If (PaletteSymbol = "#")			; Sharp
    Send x-3
If (PaletteSymbol = "##")			; Double sharp
    Send x-4
If (PaletteSymbol = "!!")			; Double flat
    Send x-5
If (PaletteSymbol = "@!")			; Natural Flat
    Send x-6
If (PaletteSymbol = "@#")			; Natural Sharp
    Send x-7
If (PaletteSymbol = "[]")			; Add brackets to accidental
    Send x-8
If (PaletteSymbol = "()")			; Add parentheses to element
    Send x-9
If (PaletteSymbol = "1fb") || (PaletteSymbol = "upb")	; ↑♭ - Gould Quarter-tone flat
    Send x-10
If (PaletteSymbol = "3fb") || (PaletteSymbol = "dnb")	; ↓♭ - Gould Three-quarter-tones flat
    Send x-11
If (PaletteSymbol = "1sn") || (PaletteSymbol = "upn")	; ↑♮ - Gould Quarter-tone sharp
    Send x-12
If (PaletteSymbol = "1fn") || (PaletteSymbol = "ndn")	; ♮↓ - Gould Quarter-tone flat
    Send x-13
If (PaletteSymbol = "3s#") || (PaletteSymbol = "sup")	; ♯↑ - Gould Three-quarter-tones sharp
    Send x-14
If (PaletteSymbol = "1s#") || (PaletteSymbol = "dns")	; ↓♯ - Gould Quarter-tone sharp
    Send x-15
If (PaletteSymbol = "5sx") || (PaletteSymbol = "xup")	; ×↑ - Gould Five-quarter-tones sharp
    Send x-16
If (PaletteSymbol = "3sx") || (PaletteSymbol = "dnx")	; ↓× - Gould Three-quarter-tones sharp
    Send x-17
If (PaletteSymbol = "3fbb") || (PaletteSymbol = "bupb")	; ♭↑♭ - Gould Three-quarter-tones flat
    Send x-18
If (PaletteSymbol = "5fbb") || (PaletteSymbol = "dnbb")	; ↓♭♭ - Gould Five-quarter-tones flat
    Send x-19

; ♣================================= ARTICULATIONS =====================================
; shortcuts in this section
; ,fm,sfm,lfm,lfmh,sfmh,vlfm,vsfm,a,.,..,t,t.,.t,l.,.l,m,a.,.a,lv,m.,.m,mt,p.,tm,..s,..w,str,ta,at
; ,unstr,sa,sa.,sat,sat.,fi,fo,vs,sls,swls,vlf,vls,o,+,h,ub,db,sp,b,tb

If (PaletteSymbol = "fm")			; Fermata
    Send a-1-
If (PaletteSymbol = "sfm")			; Short fermata above
    Send a-2-
If (PaletteSymbol = "lfm")			; Long fermata
    Send a-3-
If (PaletteSymbol = "lfmh")			; Long fermate Henze above
    Send a-4-
If (PaletteSymbol = "sfmh")			; Short fermate Henze above
    Send a-5
If (PaletteSymbol = "vlfm")			; Very long_fermata
    Send a-6
If (PaletteSymbol = "vsfm")			; Very short fermata above
    Send a-7
If (PaletteSymbol = "a")			; Sforzato, Accent above
    Send a-8
If (PaletteSymbol = ".")			; Staccato
    Send a-9
If (PaletteSymbol = "..")			; Staccatissimo
    Send a-10
If (PaletteSymbol = "t")			; Tenuto
    Send a-11
If (PaletteSymbol = "t.") || (PaletteSymbol = ".t") || (PaletteSymbol = "l.") || (PaletteSymbol = "p.")
    Send a-12					; Tenuto staccato) (Louré) (Portato)
If (PaletteSymbol = "m")			; Marcato above
    Send a-13
If (PaletteSymbol = "a.") || (PaletteSymbol = ".a") 	; Accent staccato above
    Send a-14
If (PaletteSymbol = "lv")			; Laissez vibrer above
    Send a-15
If (PaletteSymbol = "m.") || (PaletteSymbol = ".m")	; Marcato staccato above
    Send a-16
If (PaletteSymbol = "mt") || (PaletteSymbol = "tm")	; Marcato tenuto above
    Send a-17
If (PaletteSymbol = "..s") || (PaletteSymbol = "s..")	; Staccatissimo stroke above
    Send a-18
If (PaletteSymbol = "..w") || (PaletteSymbol = "w..")	; Staccatissimo wedge above
    Send a-19
If (PaletteSymbol = "str")			; Stress above
    Send a-20
If (PaletteSymbol = "ta") || (PaletteSymbol = "at")	; Tenuto accent above
    Send a-21
If (PaletteSymbol = "unstr")			; Unstress above
    Send a-22
If (PaletteSymbol = "sa")			; Soft accent above
    Send a-23
If (PaletteSymbol = "sa.")			; Soft accent staccato above
    Send a-24
If (PaletteSymbol = "sat")			; Soft accent tenuto above
    Send a-25
If (PaletteSymbol = "sat.")			; Soft accent tenuto staccato above
    Send a-26
If (PaletteSymbol = "fi")			; Fade in
    Send a-27
If (PaletteSymbol = "fo")			; Fade out
    Send a-28
If (PaletteSymbol = "vs")			; Volume swell
    Send a-29
If (PaletteSymbol = "sls")			; Sawtooth line segment
    Send a-30
If (PaletteSymbol = "swls")			; Sawtooth wide line segment
    Send a-31
If (PaletteSymbol = "vlf")			; Vibrato large faster
    Send a-32
If (PaletteSymbol = "vls")			; Vibrato large slowest
    Send a-33
If (PaletteSymbol = "o")			; Open
    Send a-34
If (PaletteSymbol = "+")			; Muted (closed)
    Send a-35
If (PaletteSymbol = "h")			; Harmonic
    Send a-36
If (PaletteSymbol = "ub")			; Upbow
    Send a-37
If (PaletteSymbol = "db")			; Downbow
    Send a-38
If (PaletteSymbol = "sp")			; Snap pizzicato above
    Send a-39
If (PaletteSymbol = "b")			; Bend
    Send a-40
If (PaletteSymbol = "tb")			; Tremolo bar
    Send a-41

; ♣================================== ORNAMENTS ========================================
; shortcuts in this section
; ,-t,-turn,+t,+turn,turn,tr,um,pr,im,trmb,prm,upr,mup,upm,dpr,prd,dm,pru,lpr,sl,slide,shtr,+t/

If (PaletteSymbol = "-t") || (PaletteSymbol = "-turn")	; Inverted turn
    Send o-1-
If (PaletteSymbol = "+t") || (PaletteSymbol = "+turn") || (PaletteSymbol = "turn")	; Turn
    Send o-2
If (PaletteSymbol = "tr")				; Trill
    Send o-3
If (PaletteSymbol = "um") || (PaletteSymbol = "pr")	; Upper Mordent  (Prall)
    Send o-4
If (PaletteSymbol = "im")				; Lower, Inverted Mordent
    Send o-5
If (PaletteSymbol = "trmb")				; Tremblement
    Send o-6
If (PaletteSymbol = "prm")				; Prall mordent
    Send o-7
If (PaletteSymbol = "upr")				; Up prall
    Send o-8
If (PaletteSymbol = "mup")				; Mordent with upper prefix
    Send o-9
If (PaletteSymbol = "upm")				; Up mordent
    Send o-10
If (PaletteSymbol = "dpr")				; Down prall (Down mordent)
    Send o-11
If (PaletteSymbol = "prd")				; Prall down
    Send o-12
If (PaletteSymbol = "dm") || (PaletteSymbol = "pru")	; Down mordent (Prall up)
    Send o-13
If (PaletteSymbol = "lpr")				; Prall up (Line Prall)
    Send o-14
If (PaletteSymbol = "sl") || (PaletteSymbol = "slide")	; Slide
    Send o-15
If (PaletteSymbol = "shtr")				; Short trill
    Send o-16
If (PaletteSymbol = "+t/")				; Turn with slash
    Send o-17

;  ♣============================ BREATHS and PAUSES ====================================
; shortcuts in this section
; ,bmc,bmt,bms,salz,bmv,c),c/,c||,c//

If (PaletteSymbol = "bmc")				; Breath mark (comma)
    Send a)
If (PaletteSymbol = "bmt")				; Breathmark tick-like
    Send ck-
If (PaletteSymbol = "bms") || (PaletteSymbol = "salz")	; Breathmark salzedo
    Send lz
If (PaletteSymbol = "bmv")				; Breathmark upbow-like
    Send w-
If (PaletteSymbol = "c)")				; Curved caesura
    Send d ca
If (PaletteSymbol = "c/")				; Caesura straight
    Send ra1
If (PaletteSymbol = "c||")				; Short caesura
    Send t ca
If (PaletteSymbol = "c//")				; Thick caesura
    Send ck c

; ♣================================= GRACE NOTES =======================================

; acs = Acciaccatura diatonically raised and slurred
; aps idem voor Appogiatura
; g6s and g3s: grace notes slurred to main note
; g6as and g3as: grace notes-after slurred from main note to next note

; shortcuts in this section
; ,ac,acs,ap,aps,g4,g6,g6s,g3,g3s,g8a,g6a,g6as,g3a,g3as

If (PaletteSymbol = "ac") || (PaletteSymbol = "acs")	; Acciaccatura
    Send cia
If (PaletteSymbol = "ap") || (PaletteSymbol = "aps")	; Appogiatura
    Send gia
If (PaletteSymbol = "g4")				; Grace quarter
    Send e: q
If (PaletteSymbol = "g6") || (PaletteSymbol = "g6s")	; Grace 16th
    Send h bef
If (PaletteSymbol = "g3") || (PaletteSymbol = "g3s")	; Grace 32nd
    Send d bef
If (PaletteSymbol = "g8a")				; Grace eight after
    Send e: e
If (PaletteSymbol = "g6a") || (PaletteSymbol = "g6as")	; Grace 16th after
    Send 6th a
If (PaletteSymbol = "g3a") || (PaletteSymbol = "g3as")	; Grace 32nd after
    Send nd a

; ♣================================= NOTEHEADS =========================================
; shortcuts in this section
; ,*n,*x,*+,*xc,*xx,*tu,*td,*/,*\,*d,*do,*c,*cl,*lar,*ab,*//,sol,la,fa,mi,do,re,ti

If (PaletteSymbol = "*n")				; Normal
    Send n-1-
If (PaletteSymbol = "*x")				; Cross
    Send n-2-
If (PaletteSymbol = "*+")				; Plus
    Send n-3
If (PaletteSymbol = "*xc")				; X circle
    Send n-4
If (PaletteSymbol = "*xx")				; With X
    Send n-5
If (PaletteSymbol = "*tu")				; Triangle up
    Send n-6
If (PaletteSymbol = "*td")				; Triangle down
    Send n-7
If (PaletteSymbol = "*/")				; Slashed forwards
    Send n-8
If (PaletteSymbol = "*\")				; Slashed backwards
    Send n-9
If (PaletteSymbol = "*d")				; Diamond
    Send n-10
If (PaletteSymbol = "*do")				; Diamond old
    Send n-11
If (PaletteSymbol = "*c")				; Circled
    Send n-12
If (PaletteSymbol = "*cl")				; Circled large
    Send n-13
If (PaletteSymbol = "*lar")				; Large arrow
    Send n-14
If (PaletteSymbol = "*ab")				; Alt brevis
    Send n-15
If (PaletteSymbol = "*//")				; Slash
    Send n-16
If (PaletteSymbol = "sol")				;  Sol
    Send n-17
If (PaletteSymbol = "la")				; La
    Send n-18
If (PaletteSymbol = "fa")				; Fa
    Send n-19
If (PaletteSymbol = "mi")				; Mi
    Send n-20
If (PaletteSymbol = "do")				; Do
    Send n-21
If (PaletteSymbol = "re")				; Re
    Send n-22
If (PaletteSymbol = "ti")				; Ti
    Send n-23

; ♣==================================== LINES ==========================================
; shortcuts in this section
; ,s,<,>,c,d,mfcp,1v,2v,3v,2vo,8va,8vb,15ma,15mb,22ma,22mb
; ,pss,ps*,psr,psc,pcc,pcr,trl,upl,dpl,ppl,tl,l,am,lr,gv,gvw,vsaw,tsaw,pm
; NB: nal -> note anchored line

If (PaletteSymbol = "s")				; Slur
    Send l-1-
If (PaletteSymbol = "<")				; HairPin crescendo
    Send l-2-
If (PaletteSymbol = ">")				; HairPin decrescendo
    Send l-3-
If (PaletteSymbol = "c")				; Cresc
    Send l-4
If (PaletteSymbol = "d")				; Dim
    Send l-5
If (PaletteSymbol = "mfcp")				; mf cresc pin
    Send l-6
If (PaletteSymbol = "1v")				; Prima Volta
    Send l-7
If (PaletteSymbol = "2v")				; Seconda volta
    Send l-8
If (PaletteSymbol = "3v")				; Terza volta
    Send l-9
If (PaletteSymbol = "2vo")				; Seconda volta open
    Send l-10
If (PaletteSymbol = "8va")				; 8va
    Send l-11
If (PaletteSymbol = "8vb")				; 8vb
    Send l-12
If (PaletteSymbol = "15ma")				; 15 ma
    Send l-13
If (PaletteSymbol = "15mb")				; 15 mb
    Send l-14
If (PaletteSymbol = "22ma")				; 22 ma
    Send l-15
If (PaletteSymbol = "22mb")				; 22 mb
    Send l-16
If (PaletteSymbol = "pss")				; Ped start stop
    Send l-17
If (PaletteSymbol = "ps*")				; Ped start asterisk
    Send l-18
If (PaletteSymbol = "psr")				; Pedline start-release
    Send l-19
If (PaletteSymbol = "psc")				; Pedline start-continue
    Send l-20
If (PaletteSymbol = "pcc")				; Pedline continue-continue
    Send l-21
If (PaletteSymbol = "pcr")				; Pedline continue-release
    Send l-22
If (PaletteSymbol = "trl")				; Trill line
    Send l-23
If (PaletteSymbol = "upl")				; Upprall line
    Send l-24
If (PaletteSymbol = "dpl")				; Downprall line
    Send l-25
If (PaletteSymbol = "ppl")				; Prall prall line
    Send l-26
If (PaletteSymbol = "tl")				; Text line
    Send l-27
If (PaletteSymbol = "l")				; Line
    Send l-28
If (PaletteSymbol = "am")				; Ambitus
    Send l-29
If (PaletteSymbol = "lr")				; Let ring
    Send l-30
If (PaletteSymbol = "gv")				; Guitar vibrato
    Send l-31
If (PaletteSymbol = "gvw")				; Guitar vibrato wide
    Send l-32
If (PaletteSymbol = "vsaw")				; Vibrato sawtooth
    Send l-33
If (PaletteSymbol = "tsaw")				; Tremolo sawtooth wide
    Send l-34
If (PaletteSymbol = "pm")				; Palm mute
    Send l-35

; ♣=================================== BARLINES ========================================
; shortcuts in this section
; ,bn,|,bd,||,bsr,|:,ber,:|,besr,:||:,dash,----,bf,|||,b.,....,bps,bt1,bt2,bs1,bs2,1:||:2

If (PaletteSymbol = "bn") || (PaletteSymbol = "|")	; Barline normal
    Send b-1-
If (PaletteSymbol = "bd") || (PaletteSymbol = "||")	; Barline double
    Send b-2
If (PaletteSymbol = "bsr") || (PaletteSymbol = "|:")	; Barline start repeat
    Send b-3
If (PaletteSymbol = "ber") || (PaletteSymbol = ":|")	; Barline end repeat
    Send b-4
If (PaletteSymbol = "besr") || (PaletteSymbol = ":||:") || (PaletteSymbol = "1:||:2")	; Barline end-start repeat
    Send b-5
If (PaletteSymbol = "dash") || (PaletteSymbol = "----")	; Barline dashed
    Send b-6
If (PaletteSymbol = "bf") || (PaletteSymbol = "|||")	; Barline final
    Send b-7
If (PaletteSymbol = "b.") || (PaletteSymbol = "....")	; Barline dotted
    Send b-8
If (PaletteSymbol = "bt1")				; Barline tick 1 span
    Send b-9
If (PaletteSymbol = "bt2")				; Barline tick 2 span
    Send b-10
If (PaletteSymbol = "bs1")				; Barline short 1 span
    Send b-11
If (PaletteSymbol = "bs2")				; Barline short 2 span
    Send b-12
If (PaletteSymbol = "bps")				; pseudo barline (symbol)
    Send b-13

; ♣============================= ARPEGGIOS and GLISSANDI ===============================
; shortcuts in this section
; ,|a,arp,|apu,apu,arpup,|apd,apd,arpdown,|ab,ab,|aau,aau,|aad,aad,|gls,gls,|glw,glw
; ,|f,fall,|d,doit,|p,plop,|s,scoop,|sod,sod,|sou,sou,|sia,sia,|sib,sib

If (PaletteSymbol = "|a") || (PaletteSymbol = "arp")	; Arp
    Send v-1-
If (PaletteSymbol = "|apu") || (PaletteSymbol = "apu") || (PaletteSymbol = "arpup")	; Arp point up
    Send v-2
If (PaletteSymbol = "|apd") || (PaletteSymbol = "apd") || (PaletteSymbol = "arpdown")	; Arp point down
    Send v-3
If (PaletteSymbol = "|ab") || (PaletteSymbol = "ab")	; Arp bracket
    Send v-4
If (PaletteSymbol = "|aau") || (PaletteSymbol = "aau")	; Arp arrow up
    Send v-5
If (PaletteSymbol = "|aad") || (PaletteSymbol = "aad")	; Arp arrow down
    Send v-6
If (PaletteSymbol = "|gls") || (PaletteSymbol = "gls")	; Gliss line straight
    Send v-7
If (PaletteSymbol = "|glw") || (PaletteSymbol = "glw")	; Gliss line wiggle
    Send v-8
If (PaletteSymbol = "|f") || (PaletteSymbol = "fall")	; Fall
    Send v-9
If (PaletteSymbol = "|d") || (PaletteSymbol = "doit")	; Doit
    Send v-10
If (PaletteSymbol = "|p") || (PaletteSymbol = "plop")	; Plop
    Send v-11
If (PaletteSymbol = "|s") || (PaletteSymbol = "scoop")	; Scoop
    Send v-12
If (PaletteSymbol = "|sod") || (PaletteSymbol = "sod")	; Slide out down
    Send v-13
If (PaletteSymbol = "|sou") || (PaletteSymbol = "sou")	; Slide out up
    Send v-14
If (PaletteSymbol = "|sia") || (PaletteSymbol = "sia")	; Slide in above
    Send v-15
If (PaletteSymbol = "|sib") || (PaletteSymbol = "sib")	; Slide in below
    Send v-16

; ♣=================================== TREMOLOS ========================================
; shortcuts in this section
; ,8,q,16,.6,sq,32,.2,dsq,64,.4,hdsq,br,buzz,8=,q=,16=,6=,sq=,32=,2=,dsq=,64=,4=,hdsq=

If (PaletteSymbol = "8") || (PaletteSymbol = "q")
    Send w-1				; 1/8 - Quaver stroke through stem
If (PaletteSymbol = "16") || (PaletteSymbol = ".6") || (PaletteSymbol = "sq")
    Send w-2				; 1/16 - SemiQ stroke through stem
If (PaletteSymbol = "32") || (PaletteSymbol = ".2") || (PaletteSymbol = "dsq")
    Send w-3				; 1/32 - DemiSQ stroke through stem
If (PaletteSymbol = "64") || (PaletteSymbol = ".4") || (PaletteSymbol = "hdsq")
    Send w-4				; 1/64 - HemiDSQ stroke through stem
If (PaletteSymbol = "br") || (PaletteSymbol = "buzz")
    Send w-5				; Buzz roll
If (PaletteSymbol = "8=") || (PaletteSymbol = "q=")
    Send w-6				; 1/8 - Quaver between notes
If (PaletteSymbol = "16=") || (PaletteSymbol = "6=") || (PaletteSymbol = "sq=")
    Send w-7				; 1/16 - SemiQ between notes
If (PaletteSymbol = "32=") || (PaletteSymbol = "2=") || (PaletteSymbol = "dsq=")
    Send w-8				; 1/32 - DemiSQ between notes
If (PaletteSymbol = "64=") || (PaletteSymbol = "4=") || (PaletteSymbol = "hdsq=")
    Send w-9				; 1/64 - HemiDSQ between notes

; ♣==================================== TEXT ===========================================
; shortcuts in this section
; #t,st,staff,#e,ex,expr,#ci,ci,#stc,stc,#rm,rm,#sw,sw,#s,sy,sys,system
; ,#p,pi,pizz,#a,ar,arco,#tr,trem,tremolo,#m,mu,mute,#o,op,open

If (PaletteSymbol = "#t") || (PaletteSymbol = "st") || (PaletteSymbol = "staff")
    Send t-1-					; Staff text
If (PaletteSymbol = "#e") || (PaletteSymbol = "ex") || (PaletteSymbol = "expr")
    Send t-2					; Expression text
If (PaletteSymbol = "#ci") || (PaletteSymbol = "ci")
    Send t-3					; Change Instrument
If (PaletteSymbol = "#stc") || (PaletteSymbol = "stc")
    Send t-4					; Staff type change
If (PaletteSymbol = "#rm") || (PaletteSymbol = "rm")
    Send t-5					; Rehearsal mark
If (PaletteSymbol = "#sw") || (PaletteSymbol = "sw")
    Send t-6					; Swing
If (PaletteSymbol = "#s") || (PaletteSymbol = "sy") || (PaletteSymbol = "sys") || (PaletteSymbol = "system")
    Send t-7					; System text
If (PaletteSymbol = "#p") || (PaletteSymbol = "pi") || (PaletteSymbol = "pizz")
    Send t-8					; Pizzicato
If (PaletteSymbol = "#a") || (PaletteSymbol = "ar") || (PaletteSymbol = "arco")
    Send t-9					; Arco
If (PaletteSymbol = "#tr") || (PaletteSymbol = "trem") || (PaletteSymbol = "tremolo")
    Send t-10					; Tremolo
If (PaletteSymbol = "#m") || (PaletteSymbol = "mu") || (PaletteSymbol = "mute")
    Send t-11					; Mute
If (PaletteSymbol = "#o") || (PaletteSymbol = "op") || (PaletteSymbol = "open")
    Send t-12					; Open

; ♣==================================== TEMPO ==========================================
; shortcuts in this section
; ,m2,m2.,m4,m4.,m8,m8.,gra,grav,grave,lar,larg,largo,len,lent,lento,ada,adag,adagi,adagio
; ,and,anda,andan,andante,mod,mode,moder,moderato,alto,a>,allegre,allegretto
; ,alro,a<,allegro,viv,viva,vivace,pre,pres,prest,presto,
; ,mm4=4.,mmc=c.,mm4.=4,mmc.=c,mm2=4,mmm=c,mm4=2,mmc=m,mm8=8,mmq=q,mm4=4,mmc=c

If (PaletteSymbol = "m2") || (PaletteSymbol = "minim")
    Send m-1-			; Half note =80
If (PaletteSymbol = "m4") || (PaletteSymbol = "crotchet")
    Send m-2-			; Quarter =80	
If (PaletteSymbol = "m8") || (PaletteSymbol = "quaver")
    Send m-3			; Eight =80
If (PaletteSymbol = "m2.") || (PaletteSymbol = "minim.")
    Send m-4			; Half note dotted =80
If (PaletteSymbol = "m4.") || (PaletteSymbol = "crotchet.")
    Send m-5			; Quarter dotted =80
If (PaletteSymbol = "m8.") || (PaletteSymbol = "quaver.")
    Send m-6			; Eight dotted =80
If (PaletteSymbol = "gra") || (PaletteSymbol = "grav") || (PaletteSymbol = "grave")
    Send m-7			; Grave 35
If (PaletteSymbol = "lar") || (PaletteSymbol = "larg") || (PaletteSymbol = "largo")
    Send m-8			; Largo 50
If (PaletteSymbol = "len") || (PaletteSymbol = "lent") || (PaletteSymbol = "lento")
    Send m-9			; Lento 52
If (PaletteSymbol = "ada") || (PaletteSymbol = "adag") || (PaletteSymbol = "adagi") || (PaletteSymbol = "adagio")
    Send m-10			; Adagio 71
If (PaletteSymbol = "and") || (PaletteSymbol = "anda") || (PaletteSymbol = "andan") || (PaletteSymbol = "andante")
    Send m-11			; Andante 92
If (PaletteSymbol = "mod") || (PaletteSymbol = "mode") || (PaletteSymbol = "moder") || (PaletteSymbol = "moderato")
    Send m-12			; Moderato 114
If (PaletteSymbol = "alto") || (PaletteSymbol = "a>") || (PaletteSymbol = "allegre") || (PaletteSymbol = "allegretto")
    Send m-13			; Allegretto 116
If (PaletteSymbol = "alro") || (PaletteSymbol = "a<") || (PaletteSymbol = "allegro")
    Send m-14			; Allegro 144
If (PaletteSymbol = "viv") || (PaletteSymbol = "viva") || (PaletteSymbol = "vivace")
    Send m-15			; Vivace 172
If (PaletteSymbol = "pre") || (PaletteSymbol = "pres") || (PaletteSymbol = "prest") || (PaletteSymbol = "presto")
    Send m-16			; Presto 187
If (PaletteSymbol = "mm4=4.") || (PaletteSymbol = "mmc=c.")
    Send m-17			; Metric modulation quarter=dotted quarter
If (PaletteSymbol = "mm4.=4") || (PaletteSymbol = "mmc.=c")
    Send m-18			; Metric modulation dotted quarter=quarter
If (PaletteSymbol = "mm2=4") || (PaletteSymbol = "mmm=c")
    Send m-19			; Metric modulation dotted quarter=quarter
If (PaletteSymbol = "mm4=2") || (PaletteSymbol = "mmc=m")
    Send m-20			; Metric modulation quarter=half
If (PaletteSymbol = "mm8=8") || (PaletteSymbol = "mmq=q")
    Send m-21			; Metric modulation eight=eight
If (PaletteSymbol = "mm4=4") || (PaletteSymbol = "mmc=c")
    Send m-22			; Metric modulation quarter=quarter

; ♣=================================== DYNAMICS ========================================
; shortcuts in this section
; ,ppp,pp,p,mp,mf,f,ff,fff,fp,sf,sfz,sff,sffz,sfp,sfpp,rfz,rf,fz,m*,r*,s*,z*,n*

If (PaletteSymbol = "ppp")				; ppp
    Send d-1-
If (PaletteSymbol = "pp")				; pp
    Send d-2-
If (PaletteSymbol = "p")				; p
    Send d-3
If (PaletteSymbol = "mp")				; mp
    Send d-4
If (PaletteSymbol = "mf")				; mf
    Send d-5
If (PaletteSymbol = "f")				; f
    Send d-6
If (PaletteSymbol = "ff")				; ff
    Send d-7
If (PaletteSymbol = "fff")				; fff
    Send d-8
If (PaletteSymbol = "fp")				; fp
    Send d-9
If (PaletteSymbol = "sf")				; sf
    Send d-10
If (PaletteSymbol = "sfz")				; sfz
    Send d-11
If (PaletteSymbol = "sff")				; sff
    Send d-12
If (PaletteSymbol = "sffz")				; sffz
    Send d-13
If (PaletteSymbol = "sfp")				; sfp
    Send d-14
If (PaletteSymbol = "sfpp")				; sfpp
    Send d-15
If (PaletteSymbol = "rfz")				; rfz
    Send d-16
If (PaletteSymbol = "rf")				; rf
    Send d-17
If (PaletteSymbol = "fz")				; fz
    Send d-18
If (PaletteSymbol = "m*")				; m
    Send d-19
If (PaletteSymbol = "r*")				; r
    Send d-20
If (PaletteSymbol = "s*")				; s
    Send d-21
If (PaletteSymbol = "z*")				; z
    Send d-22
If (PaletteSymbol = "n*")				; n
    Send d-23

; ♣================================== FINGERING ========================================
; shortcuts in this section
; ,fsa,fsb,p0,p1,p2,p3,p4,p5,-a,-c,-i,-m,-p,0,1,2,3,4,5
; ,0c,1c,2c,3c,4c,5c,6c,th,tp,lt,l1,l2,l3

If (PaletteSymbol = "p0")				; 0 - piano
    Send f-1-
If (PaletteSymbol = "p1")				; 1 - piano
    Send f-2-
If (PaletteSymbol = "p2")				; 2 - piano
    Send f-3-
If (PaletteSymbol = "p3")				; 3 - piano
    Send f-4
If (PaletteSymbol = "p4")				; 4 - piano
    Send f-5
If (PaletteSymbol = "p5")				; 5 - piano
    Send f-6
If (PaletteSymbol = "-p")				; p
    Send f-7
If (PaletteSymbol = "-i")				; i
    Send f-8
If (PaletteSymbol = "-m")				; m
    Send f-9
If (PaletteSymbol = "-a")				; a
    Send f-10
If (PaletteSymbol = "-c")				; c
    Send f-11
If (PaletteSymbol = "0")				; 0 - LH Guitar
    Send f-12
If (PaletteSymbol = "1")				; 1 - LH Guitar
    Send f-13
If (PaletteSymbol = "2")				; 2 - LH Guitar
    Send f-14
If (PaletteSymbol = "3")				; 3 - LH Guitar
    Send f-15
If (PaletteSymbol = "4")				; 4 - LH Guitar
    Send f-16
If (PaletteSymbol = "5")				; 5 - LH Guitar
    Send f-17
If (PaletteSymbol = "th")				; LH guitar fingering T
    Send f-18
If (PaletteSymbol = "0c")				; 0 in circle
    Send f-19
If (PaletteSymbol = "1c")				; 1 in circle
    Send f-20
If (PaletteSymbol = "2c")				; 2 in circle
    Send f-21
If (PaletteSymbol = "3c")				; 3 in circle
    Send f-22
If (PaletteSymbol = "4c")				; 4 in circle
    Send f-23
If (PaletteSymbol = "5c")				; 5 in circle
    Send f-24
If (PaletteSymbol = "6c")				; 6 in circle
    Send f-25
If (PaletteSymbol = "tp")				; Thumb pos
    Send f-26
If (PaletteSymbol = "lt")				; Lute thumb fing (RH fingering thumb)
    Send f-27
If (PaletteSymbol = "l1")				; Lute 1 fing (RH first finger)
    Send f-28
If (PaletteSymbol = "l2")				; Lute 2 fing (RH second finger)
    Send f-29
If (PaletteSymbol = "l3")				; Lute 3 fing (RH third finger)
    Send f-30
If (PaletteSymbol = "fsa")				; finger substitution above
    Send f-31
If (PaletteSymbol = "fsb")				; finger substitution below
    Send f-32

; ♣=============================== REPEATS and JUMPS ===================================
; shortcuts in this section
; ,rm!,!rm,r-m,r m,s!,!s,segno,s1,ss,sv,s2,c!,!c,coda,c1,vc,cv,c2,f!,!f,fine
; ,tc,dc,dcaf,dcac,dsac,dsaf,ds,sr,er,esr

If (PaletteSymbol = "rm!") || (PaletteSymbol = "!rm") || (PaletteSymbol = "r-m")
|| (PaletteSymbol = "r m")				; Repeat bar
    Send r-1-
If (PaletteSymbol = "s!") || (PaletteSymbol = "!s")
|| (PaletteSymbol = "segno") || (PaletteSymbol = "s1")	; Segno
    Send r-2
If (PaletteSymbol = "ss") || (PaletteSymbol = "sv")
|| (PaletteSymbol = "s2")				; Segno variation §
    Send r-3
If (PaletteSymbol = "c!") || (PaletteSymbol = "!c")
|| (PaletteSymbol = "coda") || (PaletteSymbol = "c1")	; Coda Φ
    Send r-4
If (PaletteSymbol = "vc") || (PaletteSymbol = "cv")
|| (PaletteSymbol = "c2")				; Varied coda
    Send r-5
If (PaletteSymbol = "f!") || (PaletteSymbol = "!f")
|| (PaletteSymbol = "fine")				; Fine
    Send r-6
If (PaletteSymbol = "tc")				; To Coda
    Send r-7
If (PaletteSymbol = "dc")				; Da Capo
    Send r-8
If (PaletteSymbol = "dcaf")				; Da Capo al Fine
    Send r-9
If (PaletteSymbol = "dcac")				; Da Capo al Coda
    Send r-10
If (PaletteSymbol = "dsac")				; Dalle Segno al Coda
    Send r-11
If (PaletteSymbol = "dsaf")				; Dalle Segno al Fine
    Send r-12
If (PaletteSymbol = "ds")				; D.S.
    Send r-13
If (PaletteSymbol = "sr")				; Start repeat
    Send r-14
If (PaletteSymbol = "er")				; End repeat
    Send r-15
If (PaletteSymbol = "esr")				; End-start repeat
    Send r-16

; ♣============================= FRETBOARD DIAGRAMS ====================================
; shortcuts in this section
; ,qa,qam,qa7,qb,qbm,qb7,qc,qcm,qc7,qd,qdm,qd7,qe,qem,qe7,qf,qfm,qf7,qg,qgm,qg7

If (PaletteSymbol = "qc")				; C
    Send q-1-
If (PaletteSymbol = "qcm")				; Cm
    Send q-2-
If (PaletteSymbol = "qc7")				; C7
    Send q-3
If (PaletteSymbol = "qd")				; D
    Send q-4
If (PaletteSymbol = "qdm")				; Dm
    Send q-5
If (PaletteSymbol = "qd7")				; D7
    Send q-6
If (PaletteSymbol = "qe")				; E
    Send q-7
If (PaletteSymbol = "qem")				; Em
    Send q-8
If (PaletteSymbol = "qe7")				; E7
    Send q-9
If (PaletteSymbol = "qf")				; F
    Send q-10
If (PaletteSymbol = "qfm")				; Fm
    Send q-11
If (PaletteSymbol = "qf7")				; F7
    Send q-12
If (PaletteSymbol = "qg")				; G
    Send q-13
If (PaletteSymbol = "qgm")				; Gm
    Send q-14
If (PaletteSymbol = "qg7")				; G7
    Send q-15
If (PaletteSymbol = "qa")				; A
    Send q-16
If (PaletteSymbol = "qam")				; Am
    Send q-17
If (PaletteSymbol = "qa7")				; A7
    Send q-18
If (PaletteSymbol = "qb")				; B
    Send q-19
If (PaletteSymbol = "qbm")				; Bm
    Send q-20
If (PaletteSymbol = "qb7")				; B7
    Send q-21

; ♣============================= BREAKS and SPACERS ====================================
; shortcuts in this section
; ,sb,pb,xb,ssd,ssu,ssf

If (PaletteSymbol = "sb")				; System break
    Send bs1
If (PaletteSymbol = "pb")				; Page break
    Send bs2
If (PaletteSymbol = "xb")				; Section break
    Send bs3
If (PaletteSymbol = "ssd")				; Staff spacer down
    Send bs4
If (PaletteSymbol = "ssu")				; Staff spacer up
    Send bs5
If (PaletteSymbol = "ssf")				; Staff spacer fixed down
    Send bs6

; ♣============================= FRAMES and MEASURES ===================================
; shortcuts in this section
; ,vf,hf,tf,1m

If (PaletteSymbol = "vf")				; Insert vertical frame
    Send fm1
If (PaletteSymbol = "hf")				; Insert horizontal frame
    Send fm2
If (PaletteSymbol = "tf")				; Insert text frame
    Send fm3
If (PaletteSymbol = "1m")				; Insert one measure
    Send fm4

; ♣================================== BRACKETS =========================================
; shortcuts in this section
; ,[[,[{,[l,[s

If (PaletteSymbol = "[[")				; Bracket
    Send bracket1
If (PaletteSymbol = "[{")				; Brace
    Send brace
If (PaletteSymbol = "[s")				; Square
    Send sq
If (PaletteSymbol = "[l")				; Line
    Send br-line

; ♣=============================== COLORED MARKER NUMBERS =====================================

; shortcuts in this section
; cm1,cm2,cm3,cm4,cm5,cm6,cm7,cm8,cm9,cm10,cm11,cm12,cm13,cm14,cm15
; user text style 'Colored Numbers': the numbers are in font Edwin, bold, 12pt, independent on staff size

If (PaletteSymbol = "cm1")				; colored marker 1 - #b30fc8 electric violet
    Send cn-1-
If (PaletteSymbol = "cm2")				; colored marker 2 - #919cb4 grayish blue
    Send cn-2-
If (PaletteSymbol = "cm3")				; colored marker 3 - #00d100 strong lime green
    Send cn-3-
If (PaletteSymbol = "cm4")				; colored marker 4 - #10ffaa lime green
    Send cn-4-
If (PaletteSymbol = "cm5")				; colored marker 5 - #006cc8 strong blue
    Send cn-5-
If (PaletteSymbol = "cm6")				; colored marker 6 - #fda900 pure (or mostly pure) orange
    Send cn-6-
If (PaletteSymbol = "cm7")				; colored marker 7 - #fa1000 pure (or mostly pure) red
    Send cn-7-
If (PaletteSymbol = "cm8")				; colored marker 8 - #5040a0 crail
    Send cn-8-
If (PaletteSymbol = "cm9")				; colored marker 9 - #d020a0 strong pink
    Send cn-9-
If (PaletteSymbol = "cm10")				; colored marker 10 - #e01040 vivid red
    Send cn-10-
If (PaletteSymbol = "cm11")				; colored marker 11 - #f09010 vivid orange
    Send cn-11-
If (PaletteSymbol = "cm12")				; colored marker 12 - #0a0fff vivid blue
    Send cn-12-
If (PaletteSymbol = "cm13")				; colored marker 13 - #90e040 bright green
    Send cn-13-
If (PaletteSymbol = "cm14")				; colored marker 14 - #00a0a0 dark cyan
    Send cn-14-
If (PaletteSymbol = "cm15")				; colored marker 15 - #a0a0a4 - LBC color
    Send cn-15-						; Layout Break Color - grey color of invisible elements

; ♣=============================== BEAM PROPERTIES =====================================

; shortcuts in this section
; ,=sb,=mb,=nb,=16b,=32b,=ab,=fbs,=fbf

If (PaletteSymbol = "=sb")				; Start a beam
    Send bp1-
If (PaletteSymbol = "=mb")				; Middle beam
    Send bp2-
If (PaletteSymbol = "=nb")				; No beam
    Send bp3-
If (PaletteSymbol = "=16b")				; Start second level beam - Beam 16th sub
    Send bp4-
If (PaletteSymbol = "=32b")				; Start third level beam - Beam 32th sub
    Send bp5-
If (PaletteSymbol = "=ab")				; Autobeam
    Send bp6-
If (PaletteSymbol = "=fbs")				; Feathered beam slower
    Send bp7-
If (PaletteSymbol = "=fbf")				; Feathered beam faster
    Send bp8-

Sleep, 100
Send ^!p					; (Ctrl+Alt+P) - MSc shortcut 'Apply current palette element' (*change*?)
Sleep, 200

; ♣======================== EXTRA OPERATIONS ON SOME GLYPHS ============================

; extra operations on some glyphs
; (1) some glyphs need more time: primarily globally operating glyphs
; keysignatures, timesignatures, barlines, and sectionbreaks
; but glissando lines,fretboard diagrams,brackets and beam properties need more time as well.
; (2) add more 16th and 32nd gracenotes before and after - g3,g6,g3a,g6a
; after first gracenote press Y to create another, press N to stop adding grace notes
; (3) add slur from  first grace-note-before to main note - g3s,g6s
; (4) add slur from main note including following gracenotes to next main note - g3as,g6as


If PaletteSymbol in 1#,2#,3#,4#,5#,6#,7#,7b,6b,5b,4b,3b,2b,1b,0#0b,xsig
,2/4,3/4,4/4,5/4,6/4,7/4,3/8,4/8,2+3/8,3+2/8,6/8,7/8,3+3+2/8,3+2+2+3/8,9/8,11/8,12/8,c4/4,2/2,3/2,4/16,5/16,6/16
,bn,|,bd,||,bsr,|:,ber,:|,besr,:||:,dash,----,bf,|||,b.,....,1:||:2
,bt1,bt2,bs1,bs2,hgls,gls,hglw,glw,er,sr,esr,qa,qam,qa7,qb,qbm,qb7,qc,qcm,qc7
,qd,qdm,qd7,qe,qem,qe7,qf,qfm,qf7,qg,qgm,qg7,xb,[[,[{,[l,[s

Sleep, 400					; (1) some glyphs need more time

If PaletteSymbol in bn,|,bd,||,bsr,|:,ber,:|,besr,:||:,dash,----,bf,|||,b.,....,1:||:2
Sleep, 400					; still more time for barlines

If PaletteSymbol in g3,g6,g3a,g6a
{						; (2) add more 16th and 32nd gracenotes before and after - g3,g6,g3a,g6a
    Tooltip, More gracenotes? Type Y.`nStop? Type N., ToolTip_2_X, 22, 2		; (*change*?)
    Loop
    {
        Input, MoreGrNs, L1, , y,n
        If (MoreGrNs = "y")
        {
            Send ^!p				; (Ctrl+Alt+P) - MSc shortcut 'Apply current palette element' (*change*?)
            Sleep, 200
            Continue
        }
        If (MoreGrNs = "n")
        Break
    }
    Sleep, 300
    Tooltip, , , , 2				; close Tooltip (2)
}

If PaletteSymbol in g3s,g6s
{						; (3) add slur from  first grace-note-before to main note- g3s,g6s
    Loop
    {
        Input, MoreGrNs, L1, , y,n
        If (MoreGrNs = "y")
        {
            Send ^!p				; (Ctrl+Alt+P) MSc shortcut 'Apply current palette element' (*change*?)
            Sleep, 200
            Continue
        }
        If (MoreGrNs = "n")
	Send s					; slur
	Send +{right %A_Index%}			; shift right x number of loop iterations
        Sleep, 100
	Send +{left}				; minus one note
	Send {Escape}
        Sleep, 50
        Break
    }
    Sleep, 800
}

If PaletteSymbol in g3as,g6as
{						; (4) add slur from main note including following gracenotes to next main note- g3as,g6as
    Loop
    {
        Input, MoreGrNs, L1, , y,n
        If (MoreGrNs = "y")
        {
            Send ^!p				; (Ctrl+Alt+P) MSc shortcut 'Apply current palette element' (*change*?)
            Sleep, 200
            Continue
        }
        If (MoreGrNs = "n")
	Send {left %A_Index%}
        Sleep, 100
	Send s
	Send +{right %A_Index%}
        Sleep, 100
	Send {Escape}
        Sleep, 50
        Break
    }
    Sleep, 1200					; needs much time to finish
}

If PaletteSymbol in 1:||:2			; can be tricky with many staves
{						; end start repeat already created
    Gosub, Inspectorcheck			; subroutine at end of script
    Sleep, 60
    Send !{left}				; volta's still to be created
    Sleep, 200
    ImageSearch, , , SB_X1, SB_Y1, SB_X2, SB_Y2, *40 Statusbar_Rest_Duration_Measure.png
    if (ErrorLevel = 0)
    Goto, SkipCtrlLeft
    if (ErrorLevel = 1)
    Send ^{left}
    SkipCtrlLeft:
    Sleep, 50
    Send ^{F9}					; Palette Search (Ctrl+F9) (*change*?)
    Sleep, 100
    Send l-7 					; Prima Volta
    Sleep, 200
    Send ^!p					; (Ctrl+Alt+P) MSc shortcut 'Apply current palette element' (*change*?)
    Sleep, 200
    Send ^{right}
    Send ^{F9}					; Palette Search (Ctrl+F9) (*change*?)
    Sleep, 200
    Send l-10					; Seconda volta open
    Sleep, 200
    Send ^!p					; (Ctrl+Alt+P) MSc shortcut 'Apply current palette element' (*change*?)
    Sleep, 200
    Return
}

; ♣========================== AFTER OPERATION on some GRACENOTES =======================

If (PaletteSymbol = "acs") || (PaletteSymbol = "aps")
{
    Send +!{up}					; grace note diatonically raised (Shift+Alt+Up)
    Send s					; slurred
    Send {Escape}
    Send {right}
    Return
}    

; ♣============================ SUPPLEMENT PSEUDO BARLINE ==============================

; moving the symbol to the correct position in the staff

If (PaletteSymbol = "bps")			; pseudo barline
{
    CoordMode, Mouse, Screen
    CoordMode, Pixel, Screen
    Gosub, Inspectorcheck			; subroutine at end of script
    Click, %IN_021_X%, %IN_021_Y%		; I(021) Y-offset - OVERLAP - ELEMENT
    Send {left}
    Sleep, 50
    Send {BS 4}					; 4 x backspace
    Sleep, 50
    Send 4					; moves symbol
    Sleep, 500					; give symbol time to move in the staff
    Send {Escape}
    Return
}

; ♣============================= SUPPLEMENT NOTE ANCHORED LINE ====================================

CreateNAL:
If (PaletteSymbol = "nal")				; note anchored line
{
    Send !a						; Alt + A, to menu Add
    Sleep, 50
    Send l						; lines
    Sleep, 50
    Send {up}						; shortest way
    Sleep, 50
    Send {Enter}					; note anchored line
    Return
}

; ♣============================= SUPPLEMENT GOULD ACCIDENTALS =====================================

; tuning quarter tones

If PaletteSymbol in 1fb,3fb,1sn,1fn,3s#,1s#,5sx,3sx,3fbb,5fbb,upb,dnb,upn,ndn,sup,dns,xup,dnx,bupb,dnbb
{
;    Gosub, InspectorCheck			; subroutine at end of script
    ImageSearch, , , IM_01_X1, IM_01_Y1, IM_01_X2, IM_01_Y2, *40 IM_01_Inspector_Inspector.png
    If ErrorLevel
    {
        MsgBox, 4112, Inspector Check, The screen is not in the defined state.`nThe accidental was added`nbut the tuning could not be applied.
        Return
    }
    Click, %IN_111_X%, %IN_111_Y%		; I(111) Tuning
    Sleep, 200
    Send ^a
    If PaletteSymbol in 1fb,upb,1fn,ndn		; Quarter-tone flat - ↑♭ - ♮↓
        Send -50
    If PaletteSymbol in 1sn,upn,1s#,dns		; Quarter-tone sharp - ↑♮ - ↓♯
        Send 50
    If PaletteSymbol in 3fb,dnb,3fbb,bupb	; Three-quarter-tones flat - ↓♭ - ♭↑♭
        Send -150
    If PaletteSymbol in 3sx,dnx,3s#,sup		; Three-quarter-tones sharp - ↓ₓ - ♯↑
        Send 150
    If PaletteSymbol in 5sx,xup			; Five-quarter-tones sharp - ₓ↑
        Send 250
    If PaletteSymbol in 5fbb,dnbb		; Five-quarter-tones flat - ↓♭♭
        Send -250
    Sleep, 50
    Gosub, VoiceSearch				; subroutine at end of script
    Click, %X%, %Y%
    Return
}
If (PaletteSymbol = "rt")
{
    Gosub, InspectorCheck			; subroutine at end of script
    Click, %IN_112_X%, %IN_112_Y%		; I(112) Reset tuning
    Sleep, 200
    Gosub, VoiceSearch				; subroutine at end of script
    Click, %X%, %Y%
    Return
}
Return

; ♣============================== MOUSE SELECT VOICE COLORED ELEMENT ==============================

~!z::					; search all voice colors and mouse select
Gosub, VoiceSearch
if ErrorLevel {
    MsgBox, 4144, Mouse Select Active Voice Color, No element found.`nMaybe there is nothing selected.`nOr its color is set invisible.`nFor tiny elements:`ntry a higher zoom factor.
    Return
}
Click, %X%, %Y%
Return

~z & x::click, right				; right click

; ♣==================================== LOAD PIXELMOUSING =========================================

~/ & p::				; load PixelMousing
Run, PixelMousing.ahk, , UseErrorLevel
if (ErrorLevel = "Error")
MsgBox, 4112, Start PixelMousing,
(
PixelMousing could not be launched.
Check name and location of the file.
)
Return

; ♣================================== RESET WIDTH INSPECTOR =======================================

~/ & w::					; semi-auto-reset of the Inspector to the Defined Width
CoordMode, Mouse, Screen
MouseGetPos, StartX, StartY			; original position
MsgBox, 4161, Reset Inspector to my Defined Width,
(
Layout of the Defined State

Make sure that the Inspector is as narrow as possible.
If not, drag its separator to the extreme right now!

Check your preferred screen size: maximized or full.
Finally check the presence of your favorite toolbars.

If everything is ready: press OK and
click an empty spot on the screen.
)
IfMsgBox, Cancel
    Return
Keywait, LButton, D
Click, up
MouseMove, % Min_Insp_Width, % A_ScreenHeight / 2	; to my found minimal (docked) Inspector width at half screen height
Sleep, 100
Click, Down						; drag enable
Sleep, 50
MouseMove, % Def_Insp_Width, % A_ScreenHeight / 2	; to my defined Inspector width at half screen height
Click, U						; drag disable
Send {Escape}
MouseMove, StartX, StartY
Return

; ♣======================================= SUBROUTINES ============================================

InspectorCheck:
ImageSearch, , , IM_01_X1, IM_01_Y1, IM_01_X2, IM_01_Y2, *40 IM_01_Inspector_Inspector.png
If ErrorLevel
{
    MsgBox, 4112, Inspector Check, The screen is not in the defined state.`nThe macro will exit.
    Exit
}
Return

VoiceSearch:
PixelSearch, X, Y, CSA_X1, CSA_Y1, CSA_X2, CSA_Y2, ColorV1, , Fast RGB
if ErrorLevel
PixelSearch, X, Y, CSA_X1, CSA_Y1, CSA_X2, CSA_Y2, ColorV2, , Fast RGB
if ErrorLevel
PixelSearch, X, Y, CSA_X1, CSA_Y1, CSA_X2, CSA_Y2, ColorV3, , Fast RGB
if ErrorLevel
PixelSearch, X, Y, CSA_X1, CSA_Y1, CSA_X2, CSA_Y2, ColorV4, , Fast RGB
Return


/*
Differences with the default Advanced Workspace of MuseScore:
Added timesig 7/4 4/8 2+3/8 3+2/8 3+3+2/8 11/8 12/8 4/16 5/16 6/16
see also https://musescore.org/en/handbook/3/time-signatures#palette-create
Added Gould arrow accidentals
Added tuning of quartertones Gould accidentals - presupposes the Defined State
Added ornament Short trill
Added Palette Colored Numbers
Added to Palette Fingering: finger substitution above, idem below
Added ┌─1─┐:‖:┌─2──  (shortcut 1:||:2)
Added pseudo barline
Added note anchored line - operates via Menu Add -> Lines
*/